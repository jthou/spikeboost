macro(set_globals)
  set(CMAKE_CXX_STANDARD 11)
  set(EXECUTABLE_OUTPUT_PATH ${CMAKE_BINARY_DIR}/bin)
  set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
  set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
  set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
  set(GTEST_OUTPUT_DIR ${CMAKE_BINARY_DIR}/bin/gtest)
  set(PYBIND11_OUTPUT_DIR ${CMAKE_BINARY_DIR}/bin/pybind11)
endmacro()

macro(message_globals)
  message(VERBOSE "-------------------------------------------------")
  message(VERBOSE "CMAKE_SYSTEM_NAME: ${CMAKE_SYSTEM_NAME}")
  message(VERBOSE "CMAKE_SYSTEM_VERSION: ${CMAKE_SYSTEM_VERSION}")
  message(VERBOSE "CMAKE_SYSTEM_PROCESSOR: ${CMAKE_SYSTEM_PROCESSOR}")
  message(VERBOSE "CMAKE_C_COMPILER: ${CMAKE_C_COMPILER}")
  message(VERBOSE "CONFIGURE_LOGCMAKE_CXX_COMPILER: ${CMAKE_CXX_COMPILER}")
  message(VERBOSE "CMAKE_CXX_FLAGS: ${CMAKE_CXX_FLAGS}")
  message(VERBOSE "CMAKE_CXX_FLAGS_DEBUG: ${CMAKE_CXX_FLAGS_DEBUG}")
  message(VERBOSE "CMAKE_CXX_FLAGS_RELEASE: ${CMAKE_CXX_FLAGS_RELEASE}")
  message(VERBOSE "CMAKE_CXX_FLAGS_MINSIZEREL: ${CMAKE_CXX_FLAGS_MINSIZEREL}")
  message(VERBOSE "CMAKE_CXX_FLAGS_RELWITHDEBINFO: ${CMAKE_CXX_FLAGS_RELWITHDEBINFO}")
  message(VERBOSE "CMAKE_INSTALL_PREFIX: ${CMAKE_INSTALL_PREFIX}")
  message(VERBOSE "CMAKE_PREFIX_PATH: ${CMAKE_PREFIX_PATH}")
  message(VERBOSE "CMAKE_MODULE_PATH: ${CMAKE_MODULE_PATH}")
  message(VERBOSE "CMAKE_CURRENT_SOURCE_DIR: ${CMAKE_CURRENT_SOURCE_DIR}")
  message(VERBOSE "CMAKE_CURRENT_BINARY_DIR: ${CMAKE_CURRENT_BINARY_DIR}")
  message(VERBOSE "CMAKE_LIBRARY_OUTPUT_DIRECTORY: ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_ARCHIVE_OUTPUT_DIRECTORY: ${CMAKE_ARCHIVE_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_RUNTIME_OUTPUT_DIRECTORY: ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_INSTALL_PREFIX: ${CMAKE_INSTALL_PREFIX}")
  message(VERBOSE "CMAKE_INSTALL_BINDIR: ${CMAKE_INSTALL_BINDIR}")
  message(VERBOSE "CMAKE_INSTALL_LIBDIR: ${CMAKE_INSTALL_LIBDIR}")
  message(VERBOSE "CMAKE_BINARY_DIR: ${CMAKE_BINARY_DIR}")
  message(VERBOSE "EXECUTABLE_OUTPUT_PATH: ${EXECUTABLE_OUTPUT_PATH}")
  message(VERBOSE "LIBRARY_OUTPUT_DIRECTORY_DEBUG: ${LIBRARY_OUTPUT_DIRECTORY_DEBUG}")
  message(VERBOSE "BINARY_OUTPUT_DIRECTORY_DEBUG: ${BINARY_OUTPUT_DIRECTORY_DEBUG}")
  message(VERBOSE "CMAKE_RUNTIME_OUTPUT_DIRECTORY: ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_LIBRARY_OUTPUT_DIRECTORY: ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_ARCHIVE_OUTPUT_DIRECTORY: ${CMAKE_ARCHIVE_OUTPUT_DIRECTORY}")
  message(VERBOSE "CMAKE_CURRENT_LIST_FILE: ${CMAKE_CURRENT_LIST_FILE}")
  message(VERBOSE "CMAKE_CURRENT_LIST_DIR: ${CMAKE_CURRENT_LIST_DIR}")
  message(VERBOSE "-------------------------------------------------")
endmacro()

macro(build_gtest)
  message(VERBOSE "build gtest")
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
  if (NOT TARGET gtest)
      add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/external/googletest ${GTEST_OUTPUT_DIR})
  else()
      message(STATUS "gtest is already a target")
  endif()
endmacro()

macro(build_pybind11)
  message(VERBOSE "build pybind11")
  if (NOT TARGET pybind11::module)
      add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/external/pybind11 ${PYBIND11_OUTPUT_DIR})
  else()
      message(STATUS "pybind11 is already a target")
  endif()
endmacro()

set_globals()
message_globals()
build_gtest()
build_pybind11()